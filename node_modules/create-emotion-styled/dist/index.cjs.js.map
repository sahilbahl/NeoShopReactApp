{"version":3,"file":"index.cjs.js","sources":["../../emotion-theming/src/channel.js","../../emotion-theming/src/create-broadcast.js","../../emotion-theming/src/utils.js","../src/utils.js","../src/index.js"],"sourcesContent":["// @flow\nexport default '__EMOTION_THEMING__'\n","// @flow\n// https://github.com/styled-components/styled-components/blob/e05b3fe247e9d956bcde786cec376e32afb85bca/src/utils/create-broadcast.js\nconst createBroadcast = (initialState: any) => {\n  const listeners: { [number]: Function | void } = {}\n  let id = 0\n  let state = initialState\n\n  function publish(nextState: any) {\n    state = nextState\n\n    for (const key in listeners) {\n      // $FlowFixMe\n      const listener = listeners[key]\n      if (listener === undefined) {\n        continue\n      }\n\n      listener(state)\n    }\n  }\n\n  function subscribe(listener: any) {\n    const currentId = id\n    listeners[currentId] = listener\n    id += 1\n    listener(state)\n    return currentId\n  }\n\n  function unsubscribe(unsubID: number) {\n    listeners[unsubID] = undefined\n  }\n\n  return { publish, subscribe, unsubscribe }\n}\n\nexport default createBroadcast\n","// @flow\nimport PropTypes from 'prop-types'\nimport channel from './channel'\n\nexport const contextTypes = {\n  [channel]: PropTypes.object\n}\n\nexport { default as channel } from './channel'\nexport { default as createBroadcast } from './create-broadcast'\n\nexport type Theme = Object | ((theme?: Object) => Object)\n","// @flow\nimport isPropValid from '@emotion/is-prop-valid'\nimport type { Interpolations } from 'create-emotion'\n\nexport function setTheme(theme: Object) {\n  this.setState({ theme })\n}\n\nexport const testPickPropsOnStringTag = isPropValid\n\nexport const testPickPropsOnComponent = (key: string) =>\n  key !== 'theme' && key !== 'innerRef'\nexport const testAlwaysTrue = () => true\n\nexport const pickAssign: (\n  testFn: (key: string) => boolean,\n  target: {},\n  ...sources: Array<{}>\n) => Object = function(testFn, target) {\n  let i = 2\n  let length = arguments.length\n  for (; i < length; i++) {\n    let source = arguments[i]\n    let key\n    for (key in source) {\n      if (testFn(key)) {\n        target[key] = source[key]\n      }\n    }\n  }\n  return target\n}\n\nexport type StyledOptions = {\n  e?: string,\n  label?: string,\n  target?: string,\n  shouldForwardProp?: (?string) => boolean\n}\n\ntype CreateStyledComponent = (...args: Interpolations) => *\n\ntype BaseCreateStyled = (\n  tag: any,\n  options?: StyledOptions\n) => CreateStyledComponent\n\nexport type CreateStyled = BaseCreateStyled & {\n  [key: string]: CreateStyledComponent\n}\n","// @flow\nimport type { Emotion, Interpolations } from 'create-emotion'\nimport { channel, contextTypes } from '../../emotion-theming/src/utils'\nimport type { ElementType } from 'react'\nimport typeof ReactType from 'react'\nimport type { CreateStyled, StyledOptions } from './utils'\nimport {\n  testPickPropsOnComponent,\n  testAlwaysTrue,\n  testPickPropsOnStringTag,\n  pickAssign,\n  setTheme\n} from './utils'\n\nfunction createEmotionStyled(emotion: Emotion, view: ReactType) {\n  let createStyled: CreateStyled = (tag, options) => {\n    if (process.env.NODE_ENV !== 'production') {\n      if (tag === undefined) {\n        throw new Error(\n          'You are trying to create a styled element with an undefined component.\\nYou may have forgotten to import it.'\n        )\n      }\n    }\n    let staticClassName\n    let identifierName\n    let stableClassName\n    let shouldForwardProp\n    if (options !== undefined) {\n      staticClassName = options.e\n      identifierName = options.label\n      stableClassName = options.target\n      shouldForwardProp =\n        tag.__emotion_forwardProp && options.shouldForwardProp\n          ? propName =>\n              tag.__emotion_forwardProp(propName) &&\n              // $FlowFixMe\n              options.shouldForwardProp(propName)\n          : options.shouldForwardProp\n    }\n    const isReal = tag.__emotion_real === tag\n    const baseTag =\n      staticClassName === undefined\n        ? (isReal && tag.__emotion_base) || tag\n        : tag\n\n    if (typeof shouldForwardProp !== 'function') {\n      shouldForwardProp =\n        typeof baseTag === 'string' &&\n        baseTag.charAt(0) === baseTag.charAt(0).toLowerCase()\n          ? testPickPropsOnStringTag\n          : testPickPropsOnComponent\n    }\n\n    return function() {\n      let args = arguments\n      let styles =\n        isReal && tag.__emotion_styles !== undefined\n          ? tag.__emotion_styles.slice(0)\n          : []\n      if (identifierName !== undefined) {\n        styles.push(`label:${identifierName};`)\n      }\n      if (staticClassName === undefined) {\n        if (args[0] == null || args[0].raw === undefined) {\n          styles.push.apply(styles, args)\n        } else {\n          styles.push(args[0][0])\n          let len = args.length\n          let i = 1\n          for (; i < len; i++) {\n            styles.push(args[i], args[0][i])\n          }\n        }\n      }\n\n      class Styled extends view.Component<*, { theme: Object }> {\n        unsubscribe: number\n        mergedProps: Object\n        static toString: () => string\n        static __emotion_real: any\n        static __emotion_styles: Interpolations\n        static __emotion_base: Styled\n        static __emotion_target: string\n        static __emotion_forwardProp: void | (string => boolean)\n        static withComponent: (ElementType, options?: StyledOptions) => any\n\n        componentWillMount() {\n          if (this.context[channel] !== undefined) {\n            this.unsubscribe = this.context[channel].subscribe(\n              setTheme.bind(this)\n            )\n          }\n        }\n        componentWillUnmount() {\n          if (this.unsubscribe !== undefined) {\n            this.context[channel].unsubscribe(this.unsubscribe)\n          }\n        }\n        render() {\n          const { props, state } = this\n          this.mergedProps = pickAssign(testAlwaysTrue, {}, props, {\n            theme: (state !== null && state.theme) || props.theme || {}\n          })\n\n          let className = ''\n          let classInterpolations = []\n\n          if (props.className) {\n            if (staticClassName === undefined) {\n              className += emotion.getRegisteredStyles(\n                classInterpolations,\n                props.className\n              )\n            } else {\n              className += `${props.className} `\n            }\n          }\n          if (staticClassName === undefined) {\n            className += emotion.css.apply(\n              this,\n              styles.concat(classInterpolations)\n            )\n          } else {\n            className += staticClassName\n          }\n\n          if (stableClassName !== undefined) {\n            className += ` ${stableClassName}`\n          }\n\n          return view.createElement(\n            baseTag,\n            // $FlowFixMe\n            pickAssign(shouldForwardProp, {}, props, {\n              className,\n              ref: props.innerRef\n            })\n          )\n        }\n      }\n      Styled.displayName =\n        identifierName !== undefined\n          ? identifierName\n          : `Styled(${\n              typeof baseTag === 'string'\n                ? baseTag\n                : baseTag.displayName || baseTag.name || 'Component'\n            })`\n\n      if (tag.defaultProps !== undefined) {\n        // $FlowFixMe\n        Styled.defaultProps = tag.defaultProps\n      }\n      Styled.contextTypes = contextTypes\n      Styled.__emotion_styles = styles\n      Styled.__emotion_base = baseTag\n      Styled.__emotion_real = Styled\n      Styled.__emotion_forwardProp = shouldForwardProp\n      Object.defineProperty(Styled, 'toString', {\n        enumerable: false,\n        value() {\n          if (\n            process.env.NODE_ENV !== 'production' &&\n            stableClassName === undefined\n          ) {\n            return 'NO_COMPONENT_SELECTOR'\n          }\n          // $FlowFixMe\n          return `.${stableClassName}`\n        }\n      })\n\n      Styled.withComponent = (\n        nextTag: ElementType,\n        nextOptions?: StyledOptions\n      ) => {\n        return createStyled(\n          nextTag,\n          nextOptions !== undefined\n            ? // $FlowFixMe\n              pickAssign(testAlwaysTrue, {}, options, nextOptions)\n            : options\n        )(...styles)\n      }\n\n      return Styled\n    }\n  }\n  if (process.env.NODE_ENV !== 'production' && typeof Proxy !== 'undefined') {\n    createStyled = new Proxy(createStyled, {\n      get(target, property) {\n        switch (property) {\n          // react-hot-loader tries to access this stuff\n          case '__proto__':\n          case 'name':\n          case 'prototype':\n          case 'displayName': {\n            return target[property]\n          }\n          default: {\n            throw new Error(\n              `You're trying to use the styled shorthand without babel-plugin-emotion.` +\n                `\\nPlease install and setup babel-plugin-emotion or use the function call syntax(\\`styled('${property}')\\` instead of \\`styled.${property}\\`)`\n            )\n          }\n        }\n      }\n    })\n  }\n  return createStyled\n}\n\nexport default createEmotionStyled\n"],"names":["contextTypes","channel","PropTypes","object","setTheme","theme","setState","testPickPropsOnStringTag","isPropValid","testPickPropsOnComponent","key","testAlwaysTrue","pickAssign","testFn","target","i","length","arguments","source","createEmotionStyled","emotion","view","createStyled","tag","options","process","env","NODE_ENV","undefined","Error","staticClassName","identifierName","stableClassName","shouldForwardProp","e","label","__emotion_forwardProp","propName","isReal","__emotion_real","baseTag","__emotion_base","charAt","toLowerCase","args","styles","__emotion_styles","slice","push","raw","apply","len","Styled","componentWillMount","context","unsubscribe","subscribe","bind","componentWillUnmount","render","props","state","mergedProps","className","classInterpolations","getRegisteredStyles","css","concat","createElement","innerRef","Component","displayName","name","defaultProps","defineProperty","withComponent","nextTag","nextOptions","Proxy","property"],"mappings":"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"}